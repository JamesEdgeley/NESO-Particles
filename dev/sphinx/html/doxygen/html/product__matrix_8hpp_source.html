<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NESO Particles: /tmp/repo-checkout/NESO-Particles/include/containers/product_matrix.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NESO Particles
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_c35e9bb330ad51bde60aaf7a3563beec.html">containers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">product_matrix.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="product__matrix_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _NESO_PARTICLES_PRODUCT_MATRIX_H_</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _NESO_PARTICLES_PRODUCT_MATRIX_H_</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;../compute_target.hpp&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;../loop/access_descriptors.hpp&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;../loop/particle_loop_base.hpp&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;../particle_spec.hpp&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceNESO_1_1Particles.html">NESO::Particles</a> {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">class </span>ProductMatrix;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">   18</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> {</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#ac9e69f2a7f0c1a0e95891b20a26bd291">   19</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#ac9e69f2a7f0c1a0e95891b20a26bd291">ptr_real</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a79dd138947ccaaedb1b6255561676301">   20</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a79dd138947ccaaedb1b6255561676301">ptr_int</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a27ecaa82dceb6278936325eb17307e5a">   21</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a27ecaa82dceb6278936325eb17307e5a">offsets_real</a>;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a8c68504b405bda965b11c02d8a5087a2">   22</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a8c68504b405bda965b11c02d8a5087a2">offsets_int</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a7a8e24db445e735a2c882bbfa31ddf07">   23</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a7a8e24db445e735a2c882bbfa31ddf07">num_products</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;};</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">   26</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a> {</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a6b7948ee6a0f420eb2064e207e0bf7c6">   27</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a6b7948ee6a0f420eb2064e207e0bf7c6">ptr_real</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a3d0ef94213054ab1ff3b247d15401a9a">   28</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a3d0ef94213054ab1ff3b247d15401a9a">ptr_int</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#acdf3a3c4288178483f219b558350d87d">   29</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#acdf3a3c4288178483f219b558350d87d">offsets_real</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a7746eaa22c0e658a819ef028fcd36d25">   30</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a7746eaa22c0e658a819ef028fcd36d25">offsets_int</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a19384039656e013c133882369a7903eb">   31</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a19384039656e013c133882369a7903eb">num_products</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1Access_1_1ProductMatrix.html">   37</a></span>&#160;<span class="keyword">namespace </span>Access::ProductMatrix {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">   47</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">Read</a> {</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a5a8bb615e2efca50b383a6bd1840baeb">   48</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a5a8bb615e2efca50b383a6bd1840baeb">Read</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#acef5ea2a30b64a45035e739c18d73bef">   49</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#acef5ea2a30b64a45035e739c18d73bef">ptr_real</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a1c51f50f8a92ea3611498963257f3174">   50</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a1c51f50f8a92ea3611498963257f3174">ptr_int</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a109e69e77b81d0144db17443a1227c98">   51</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a109e69e77b81d0144db17443a1227c98">offsets_real</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3a6a280fcc226f9e7d2f2de5206ac0b3">   52</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3a6a280fcc226f9e7d2f2de5206ac0b3">offsets_int</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">   53</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">num_products</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#ae59a3f0e8e1cfecdad0a520f27831002">   64</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#ae59a3f0e8e1cfecdad0a520f27831002">at_real</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">int</span> component)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#acef5ea2a30b64a45035e739c18d73bef">ptr_real</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a109e69e77b81d0144db17443a1227c98">offsets_real</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">num_products</a> +</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    product];</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#aa4b3e9fa140498c5784103cc949c4275">   79</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#aa4b3e9fa140498c5784103cc949c4275">at_int</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> component)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a1c51f50f8a92ea3611498963257f3174">ptr_int</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3a6a280fcc226f9e7d2f2de5206ac0b3">offsets_int</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">num_products</a> +</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                   product];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;};</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html">   89</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html">Add</a> {</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a092f0b2f2ce70f1799a9773fabea88e3">   90</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a092f0b2f2ce70f1799a9773fabea88e3">Add</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9c918c0a7f3803454be7e1fed082e9b7">   91</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9c918c0a7f3803454be7e1fed082e9b7">ptr_real</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#ae4d38dada5b74b84f9279e4bc5b7127a">   92</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#ae4d38dada5b74b84f9279e4bc5b7127a">ptr_int</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a936654066f9d1c28c8f0cf5b71895d9b">   93</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a936654066f9d1c28c8f0cf5b71895d9b">offsets_real</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9aa679139ab41ab7933c70524373d475">   94</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9aa679139ab41ab7933c70524373d475">offsets_int</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a0b8bee33aa8a7dd349d12871f6f7a33d">   95</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a0b8bee33aa8a7dd349d12871f6f7a33d">num_products</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a7a7e9b30db9274b11fe195df68f3f875">  108</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a7a7e9b30db9274b11fe195df68f3f875">fetch_add_real</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">int</span> component, <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> value) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    sycl::atomic_ref&lt;<a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a>, sycl::memory_order::relaxed,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                     sycl::memory_scope::device&gt;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        element_atomic(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9c918c0a7f3803454be7e1fed082e9b7">ptr_real</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a936654066f9d1c28c8f0cf5b71895d9b">offsets_real</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a0b8bee33aa8a7dd349d12871f6f7a33d">num_products</a> +</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                     product]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> element_atomic.fetch_add(value);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#aec8797408d6d3c99f8f4f5fbb2bf962c">  129</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#aec8797408d6d3c99f8f4f5fbb2bf962c">fetch_add_int</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">int</span> component, <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> value) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    sycl::atomic_ref&lt;<a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a>, sycl::memory_order::relaxed,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                     sycl::memory_scope::device&gt;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        element_atomic(</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#ae4d38dada5b74b84f9279e4bc5b7127a">ptr_int</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9aa679139ab41ab7933c70524373d475">offsets_int</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a0b8bee33aa8a7dd349d12871f6f7a33d">num_products</a> +</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    product]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">return</span> element_atomic.fetch_add(value);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;};</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html">  143</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html">Write</a> {</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#af23f6e0c2e44e5b874209cdbeb1d924f">  145</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#af23f6e0c2e44e5b874209cdbeb1d924f">Write</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a84911c8a18e14671a1bb5bab56f4483e">  146</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a84911c8a18e14671a1bb5bab56f4483e">ptr_real</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a090627d1289b79d0b210a2cd801b4d17">  147</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a090627d1289b79d0b210a2cd801b4d17">ptr_int</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a99796ac07983f837061a0431ceba2a83">  148</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a99796ac07983f837061a0431ceba2a83">offsets_real</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#ae3b26a8cd3f6e7e6810f7389c6f1159a">  149</a></span>&#160;  <span class="keywordtype">int</span> <span class="keyword">const</span> *<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#ae3b26a8cd3f6e7e6810f7389c6f1159a">offsets_int</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#abf7bbb38a2afed9d48b85cface0d92f6">  150</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#abf7bbb38a2afed9d48b85cface0d92f6">num_products</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a509e7d32ab1a794ac559676b22bad978">  162</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a509e7d32ab1a794ac559676b22bad978">at_real</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property, <span class="keyword">const</span> <span class="keywordtype">int</span> component) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a84911c8a18e14671a1bb5bab56f4483e">ptr_real</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a99796ac07983f837061a0431ceba2a83">offsets_real</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#abf7bbb38a2afed9d48b85cface0d92f6">num_products</a> +</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    product];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a8be413685b28a0e67fbd287747b9292b">  177</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a8be413685b28a0e67fbd287747b9292b">at_int</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> product, <span class="keyword">const</span> <span class="keywordtype">int</span> property, <span class="keyword">const</span> <span class="keywordtype">int</span> component) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a090627d1289b79d0b210a2cd801b4d17">ptr_int</a>[(<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#ae3b26a8cd3f6e7e6810f7389c6f1159a">offsets_int</a>[property] + component) * <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#abf7bbb38a2afed9d48b85cface0d92f6">num_products</a> +</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                   product];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;};</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;} <span class="comment">// namespace Access::ProductMatrix</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keyword">namespace </span>ParticleLoopImplementation {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01ProductMatrix_01_4_01_4.html">  190</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter.html">LoopParameter</a>&lt;Access::Read&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01ProductMatrix_01_4_01_4.html#ad3a99ff4c5e4dddc3c5870e0de5b75e8">  191</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;};</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01ProductMatrix_01_4_01_4.html">  196</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter.html">LoopParameter</a>&lt;Access::Write&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01ProductMatrix_01_4_01_4.html#ab2b6fa53c812eaf717f4a4244fa3d852">  197</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;};</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01ProductMatrix_01_4_01_4.html">  202</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter.html">LoopParameter</a>&lt;Access::Add&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01ProductMatrix_01_4_01_4.html#a3c39df5571f31b84f5dc7493a21573c2">  203</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;};</div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Read_3_01ProductMatrix_01_4_01_4.html">  208</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter.html">KernelParameter</a>&lt;Access::Read&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Read_3_01ProductMatrix_01_4_01_4.html#ab679244d745da98d8fc47fbef03cce3f">  209</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">Access::ProductMatrix::Read</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;};</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Write_3_01ProductMatrix_01_4_01_4.html">  214</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter.html">KernelParameter</a>&lt;Access::Write&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Write_3_01ProductMatrix_01_4_01_4.html#ac0a1d10e0f37b9ce48707d6dbdf7aeeb">  215</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html">Access::ProductMatrix::Write</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;};</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Add_3_01ProductMatrix_01_4_01_4.html">  220</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter.html">KernelParameter</a>&lt;Access::Add&lt;ProductMatrix&gt;&gt; {</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Add_3_01ProductMatrix_01_4_01_4.html#ab22420cec1d095486f39645f22a4e817">  221</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html">type</a> = <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html">Access::ProductMatrix::Add</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;};</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#a0ee19bf5c390251e52103e36ee91a767">  226</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#af4dcf9f325fb9449418a41ce0fc6d746">create_kernel_arg</a>(<a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration.html">ParticleLoopIteration</a> &amp;iterationx,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                              <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a> &amp;rhs,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                              <a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">Access::ProductMatrix::Read</a> &amp;lhs) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  lhs.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#acef5ea2a30b64a45035e739c18d73bef">ptr_real</a> = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a6b7948ee6a0f420eb2064e207e0bf7c6">ptr_real</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  lhs.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a1c51f50f8a92ea3611498963257f3174">ptr_int</a> = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a3d0ef94213054ab1ff3b247d15401a9a">ptr_int</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  lhs.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a109e69e77b81d0144db17443a1227c98">offsets_real</a> = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#acdf3a3c4288178483f219b558350d87d">offsets_real</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  lhs.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3a6a280fcc226f9e7d2f2de5206ac0b3">offsets_int</a> = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a7746eaa22c0e658a819ef028fcd36d25">offsets_int</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  lhs.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">num_products</a> = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a19384039656e013c133882369a7903eb">num_products</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#ac8c49152dbbf36c173e490c9578f6127">  239</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#af4dcf9f325fb9449418a41ce0fc6d746">create_kernel_arg</a>(<a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration.html">ParticleLoopIteration</a> &amp;iterationx,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                              <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> &amp;rhs, T &amp;lhs) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  lhs.ptr_real = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#ac9e69f2a7f0c1a0e95891b20a26bd291">ptr_real</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  lhs.ptr_int = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a79dd138947ccaaedb1b6255561676301">ptr_int</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  lhs.offsets_real = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a27ecaa82dceb6278936325eb17307e5a">offsets_real</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  lhs.offsets_int = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a8c68504b405bda965b11c02d8a5087a2">offsets_int</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  lhs.num_products = rhs.<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a7a8e24db445e735a2c882bbfa31ddf07">num_products</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(ParticleLoopGlobalInfo *global_info, sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Read.html">Access::Read&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(ParticleLoopGlobalInfo *global_info,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                        sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                        <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Write.html">Access::Write&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(ParticleLoopGlobalInfo *global_info,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                        sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                        <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Add.html">Access::Add&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;} <span class="comment">// namespace ParticleLoopImplementation</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html">  272</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html">ProductMatrixSpec</a> {</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae273bdefefb8f958d4bf4cb7a0c7a7b5">  274</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae273bdefefb8f958d4bf4cb7a0c7a7b5">num_components_real</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9a7054fdc1b3a2474181858351e412bc">  276</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9a7054fdc1b3a2474181858351e412bc">num_components_int</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">  278</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">num_properties_real</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">  280</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">num_properties_int</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ac72e1a4ad5464c7b97678c02c0af32ad">  282</a></span>&#160;  std::vector&lt;Sym&lt;REAL&gt;&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ac72e1a4ad5464c7b97678c02c0af32ad">syms_real</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#aea4cc983e388d36ebb3ab47d02e2713d">  284</a></span>&#160;  std::vector&lt;Sym&lt;INT&gt;&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#aea4cc983e388d36ebb3ab47d02e2713d">syms_int</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b2431397961c923f4f58ad08159a699">  286</a></span>&#160;  std::vector&lt;int&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b2431397961c923f4f58ad08159a699">components_real</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ad9ff6164237eb6d74171549702fff442">  288</a></span>&#160;  std::vector&lt;int&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ad9ff6164237eb6d74171549702fff442">components_int</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a4553b2c502650c65d4c4db1bcc9f3c7f">  290</a></span>&#160;  std::map&lt;std::pair&lt;Sym&lt;REAL&gt;, <span class="keywordtype">int</span>&gt;, <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a>&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a4553b2c502650c65d4c4db1bcc9f3c7f">default_values_real</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9f1269bcfdbc18f0ebdd1b4ad1c29d55">  292</a></span>&#160;  std::map&lt;std::pair&lt;Sym&lt;INT&gt;, <span class="keywordtype">int</span>&gt;, <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a>&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9f1269bcfdbc18f0ebdd1b4ad1c29d55">default_values_int</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a71678c9c640af008237c72b7b4031f29">  294</a></span>&#160;  std::map&lt;Sym&lt;REAL&gt;, <span class="keywordtype">int</span>&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a71678c9c640af008237c72b7b4031f29">map_sym_index_real</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1e1e971fce76dee24f8b97331a91f328">  296</a></span>&#160;  std::map&lt;Sym&lt;INT&gt;, <span class="keywordtype">int</span>&gt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1e1e971fce76dee24f8b97331a91f328">map_sym_index_int</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">  299</a></span>&#160;  <a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html">ParticleSpec</a> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a158f2d9e91561033eccc01802cb09a24">  301</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a158f2d9e91561033eccc01802cb09a24">ProductMatrixSpec</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae9072103019d477721f463db865f1dc4">  302</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html">ProductMatrixSpec</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae9072103019d477721f463db865f1dc4">operator=</a>(<span class="keyword">const</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html">ProductMatrixSpec</a> &amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a5dfc076cb0df6971d26a272813af1fb1">  309</a></span>&#160;  <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a5dfc076cb0df6971d26a272813af1fb1">ProductMatrixSpec</a>(<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html">ParticleSpec</a> &amp;<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      : <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>(<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    this-&gt;num_properties_real = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aa33c982494fe5adb6007f3daad7fb622">properties_real</a>.size();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    this-&gt;num_properties_int = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aeb5bac880755c38534d630b16de36004">properties_int</a>.size();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    this-&gt;components_real = std::vector&lt;int&gt;(<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">num_properties_real</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    this-&gt;components_int = std::vector&lt;int&gt;(<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">num_properties_int</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    this-&gt;syms_real = std::vector&lt;Sym&lt;REAL&gt;&gt;(<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">num_properties_real</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    this-&gt;syms_int = std::vector&lt;Sym&lt;INT&gt;&gt;(<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">num_properties_int</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> px = 0; px &lt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">num_properties_real</a>; px++) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      this-&gt;components_real.at(px) = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aa33c982494fe5adb6007f3daad7fb622">properties_real</a>.at(px).ncomp;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> sym = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aa33c982494fe5adb6007f3daad7fb622">properties_real</a>.at(px).sym;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      this-&gt;syms_real.at(px) = sym;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      this-&gt;map_sym_index_real[sym] = px;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> px = 0; px &lt; <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">num_properties_int</a>; px++) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      this-&gt;components_int.at(px) = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aeb5bac880755c38534d630b16de36004">properties_int</a>.at(px).ncomp;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> sym = <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">particle_spec</a>.<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html#aeb5bac880755c38534d630b16de36004">properties_int</a>.at(px).sym;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      this-&gt;syms_int.at(px) = sym;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      this-&gt;map_sym_index_int[sym] = px;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    this-&gt;num_components_real = std::accumulate(this-&gt;components_real.begin(),</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                                this-&gt;components_real.end(), 0);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    this-&gt;num_components_int = std::accumulate(this-&gt;components_int.begin(),</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                               this-&gt;components_int.end(), 0);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b402151bc42788762a21a3439ff0604">  344</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b402151bc42788762a21a3439ff0604">set_default_value</a>(<a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;INT&gt;</a> sym, <span class="keyword">const</span> <span class="keywordtype">int</span> component,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> value) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    this-&gt;default_values_int[{sym, component}] = value;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2c52ff03bd412f9e1fddfa2eab35495f">  356</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2c52ff03bd412f9e1fddfa2eab35495f">set_default_value</a>(<a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;REAL&gt;</a> sym, <span class="keyword">const</span> <span class="keywordtype">int</span> component,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> value) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    this-&gt;default_values_real[{sym, component}] = value;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#acdb63dc057ce80cd35ec56d1f9be8b03">  365</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#acdb63dc057ce80cd35ec56d1f9be8b03">get_sym_index</a>(<span class="keyword">const</span> <a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;REAL&gt;</a> sym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">auto</span> it = this-&gt;map_sym_index_real.find(sym);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (it == this-&gt;map_sym_index_real.end()) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a32a2d4fdf26bd2e56d3e0eecec888eb6">  378</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a32a2d4fdf26bd2e56d3e0eecec888eb6">get_sym_index</a>(<span class="keyword">const</span> <a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;INT&gt;</a> sym)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keyword">auto</span> it = this-&gt;map_sym_index_int.find(sym);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> (it == this-&gt;map_sym_index_int.end()) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1a9616219ab019b6d7c749d6199c0cb9">  390</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1a9616219ab019b6d7c749d6199c0cb9">get_num_components</a>(<span class="keyword">const</span> <a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;REAL&gt;</a> sym) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> index = this-&gt;<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#acdb63dc057ce80cd35ec56d1f9be8b03">get_sym_index</a>(sym);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (index &lt; 0) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">return</span> this-&gt;components_real.at(index);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a832cc86477fee3843edcd029398007d3">  402</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a832cc86477fee3843edcd029398007d3">get_num_components</a>(<span class="keyword">const</span> <a class="code" href="classNESO_1_1Particles_1_1Sym.html">Sym&lt;INT&gt;</a> sym) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> index = this-&gt;<a class="code" href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#acdb63dc057ce80cd35ec56d1f9be8b03">get_sym_index</a>(sym);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (index &lt; 0) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">return</span> this-&gt;components_int.at(index);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;};</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keyword">inline</span> std::shared_ptr&lt;ProductMatrixSpec&gt;</div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles.html#aa6deabc4271b453cf01c32cac1a945fd">  418</a></span>&#160;<a class="code" href="namespaceNESO_1_1Particles.html#aa6deabc4271b453cf01c32cac1a945fd">product_matrix_spec</a>(<a class="code" href="classNESO_1_1Particles_1_1ParticleSpec.html">ParticleSpec</a> particle_spec) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;ProductMatrixSpec&gt;(particle_spec);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html">  430</a></span>&#160;<span class="keyword">class </span><a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html">ProductMatrix</a> {</div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#accfc1abb2f69f7720d802ebc0e73117e">  431</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classNESO_1_1Particles_1_1ParticleGroup.html">ParticleGroup</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keyword">friend</span> <span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a></div>
<div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#afebb1772502f56862f18d953fed55a1c">  433</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">ParticleLoopImplementation::create_loop_arg</a>(</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopImplementation::ParticleLoopGlobalInfo</a> *global_info,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      sycl::handler &amp;cgh, <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Read.html">Access::Read&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a860de4f83b61dce730da0e64edbf60c9">  436</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">ParticleLoopImplementation::create_loop_arg</a>(</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopImplementation::ParticleLoopGlobalInfo</a> *global_info,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      sycl::handler &amp;cgh, <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Write.html">Access::Write&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a710b2c5b5ae95808ff6fb8c025937ae3">  439</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">ParticleLoopImplementation::create_loop_arg</a>(</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopImplementation::ParticleLoopGlobalInfo</a> *global_info,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      sycl::handler &amp;cgh, <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Add.html">Access::Add&lt;ProductMatrix *&gt;</a> &amp;a);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a4de28c1890fe75fe7dea47580a8eb920">  444</a></span>&#160;  std::shared_ptr&lt;BufferDevice&lt;REAL&gt;&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a4de28c1890fe75fe7dea47580a8eb920">d_data_real</a>;</div>
<div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#acd8862302e451df9bf66deacd64b3036">  445</a></span>&#160;  std::shared_ptr&lt;BufferDevice&lt;INT&gt;&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#acd8862302e451df9bf66deacd64b3036">d_data_int</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#ae42ded6981e0e85018ea7e619995aa88">  446</a></span>&#160;  std::shared_ptr&lt;BufferDeviceHost&lt;int&gt;&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#ae42ded6981e0e85018ea7e619995aa88">dh_offsets_real</a>;</div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a2e84197159db429c900407a9c2a046da">  447</a></span>&#160;  std::shared_ptr&lt;BufferDeviceHost&lt;int&gt;&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a2e84197159db429c900407a9c2a046da">dh_offsets_int</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a7a85c983fe3d19e2a3a49fcd50db9ca1">  449</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a7a85c983fe3d19e2a3a49fcd50db9ca1">impl_get</a>() {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> {this-&gt;d_data_real-&gt;ptr, this-&gt;d_data_int-&gt;ptr,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            this-&gt;dh_offsets_real-&gt;d_buffer.ptr,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            this-&gt;dh_offsets_int-&gt;d_buffer.ptr, this-&gt;<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>};</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a3bc081cdac6a89a5882917806845027c">  454</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">ProductMatrixGetConst</a> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a3bc081cdac6a89a5882917806845027c">impl_get_const</a>() {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">return</span> {this-&gt;d_data_real-&gt;ptr, this-&gt;d_data_int-&gt;ptr,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            this-&gt;dh_offsets_real-&gt;d_buffer.ptr,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            this-&gt;dh_offsets_int-&gt;d_buffer.ptr, this-&gt;<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>};</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">  462</a></span>&#160;  <a class="code" href="namespaceNESO_1_1Particles.html#a897f23893a83614b3f78e2f08d7aad71">SYCLTargetSharedPtr</a> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">  464</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">  466</a></span>&#160;  std::shared_ptr&lt;ProductMatrixSpec&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a1e99906277466047744de32bd3be98bc">  468</a></span>&#160;  <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a1e99906277466047744de32bd3be98bc">ProductMatrix</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a9fee81f0ff3286fc1f4c72a6dd928b8e">  473</a></span>&#160;  <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html">ProductMatrix</a> &amp;<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a9fee81f0ff3286fc1f4c72a6dd928b8e">operator=</a>(<span class="keyword">const</span> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html">ProductMatrix</a> &amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#a99922a29e95d64ce9e8db21626a87372">  484</a></span>&#160;  <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a99922a29e95d64ce9e8db21626a87372">ProductMatrix</a>(<a class="code" href="namespaceNESO_1_1Particles.html#a897f23893a83614b3f78e2f08d7aad71">SYCLTargetSharedPtr</a> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                std::shared_ptr&lt;ProductMatrixSpec&gt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      : <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>), <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="typedefs_8hpp.html#ac780e64fe76ab7e5f6b07c55de92d018">NESOASSERT</a>(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a> != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;sycl_target is nullptr.&quot;</span>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    this-&gt;d_data_real = std::make_shared&lt;BufferDevice&lt;REAL&gt;&gt;(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>, 1);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    this-&gt;d_data_int = std::make_shared&lt;BufferDevice&lt;INT&gt;&gt;(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>, 1);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// These offsets are functions of the properties and components not the</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// number of products</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// REAL offsets</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    std::vector&lt;int&gt; h_offsets_real(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_real.size());</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    std::exclusive_scan(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_real.begin(),</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_real.end(), h_offsets_real.begin(), 0);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    this-&gt;dh_offsets_real =</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        std::make_shared&lt;BufferDeviceHost&lt;int&gt;&gt;(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>, h_offsets_real);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    this-&gt;dh_offsets_real-&gt;host_to_device();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// INT offsets</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    std::vector&lt;int&gt; h_offsets_int(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_int.size());</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    std::exclusive_scan(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_int.begin(),</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_int.end(), h_offsets_int.begin(), 0);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    this-&gt;dh_offsets_int =</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        std::make_shared&lt;BufferDeviceHost&lt;int&gt;&gt;(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">sycl_target</a>, h_offsets_int);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    this-&gt;dh_offsets_int-&gt;host_to_device();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="line" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa1cab6680f0e17928d253ba02ebc581f">  520</a></span>&#160;  <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aa1cab6680f0e17928d253ba02ebc581f">reset</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a> = this-&gt;spec.get();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="typedefs_8hpp.html#ac780e64fe76ab7e5f6b07c55de92d018">NESOASSERT</a>(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a> != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ProductMatrix is not initialised.&quot;</span>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    this-&gt;num_products = <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    this-&gt;d_data_real-&gt;realloc_no_copy(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a> *</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                       <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;num_components_real);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    this-&gt;d_data_int-&gt;realloc_no_copy(<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a> * <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;num_components_int);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="classNESO_1_1Particles_1_1EventStack.html">EventStack</a> es;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// reset the values to either 0 or the set default value</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sx = 0; sx &lt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;num_properties_real; sx++) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cx = 0; cx &lt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_real[sx]; cx++) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keyword">const</span> std::pair&lt;Sym&lt;REAL&gt;, <span class="keywordtype">int</span>&gt; key = {<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;syms_real.at(sx), cx};</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> value = <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;default_values_real.count(key) &gt; 0</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                               ? <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;default_values_real.at(key)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                               : 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> sym_offset = this-&gt;dh_offsets_real-&gt;h_buffer.ptr[sx];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">REAL</a> *column_start =</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            this-&gt;d_data_real-&gt;ptr + (sym_offset + cx) * <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        es.<a class="code" href="classNESO_1_1Particles_1_1EventStack.html#aee8a0be331891915bf8dccd4359aea20">push</a>(</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            this-&gt;sycl_target-&gt;queue.fill(column_start, value, <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>));</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sx = 0; sx &lt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;num_properties_int; sx++) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cx = 0; cx &lt; <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;components_int[sx]; cx++) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keyword">const</span> std::pair&lt;Sym&lt;INT&gt;, <span class="keywordtype">int</span>&gt; key = {<a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;syms_int.at(sx), cx};</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> value = <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;default_values_int.count(key) &gt; 0</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                              ? <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">spec</a>-&gt;default_values_int.at(key)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                              : 0;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> sym_offset = this-&gt;dh_offsets_int-&gt;h_buffer.ptr[sx];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">INT</a> *column_start =</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            this-&gt;d_data_int-&gt;ptr + (sym_offset + cx) * <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        es.<a class="code" href="classNESO_1_1Particles_1_1EventStack.html#aee8a0be331891915bf8dccd4359aea20">push</a>(</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            this-&gt;sycl_target-&gt;queue.fill(column_start, value, <a class="code" href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">num_products</a>));</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    es.<a class="code" href="classNESO_1_1Particles_1_1EventStack.html#a6904b30365c9a305408d7db689487aa3">wait</a>();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;};</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keyword">inline</span> std::shared_ptr&lt;ProductMatrix&gt;</div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles.html#a914c9c125729aade07b9ff53fa35d978">  569</a></span>&#160;<a class="code" href="namespaceNESO_1_1Particles.html#a914c9c125729aade07b9ff53fa35d978">product_matrix</a>(<a class="code" href="namespaceNESO_1_1Particles.html#a897f23893a83614b3f78e2f08d7aad71">SYCLTargetSharedPtr</a> sycl_target,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;               std::shared_ptr&lt;ProductMatrixSpec&gt; spec) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;ProductMatrix&gt;(sycl_target, spec);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;}</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keyword">namespace </span>ParticleLoopImplementation {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keyword">inline</span> ProductMatrixGetConst</div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#a590eb99e2ec1c2031619df1e138e4542">  579</a></span>&#160;<a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(<a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopGlobalInfo</a> *global_info, sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Read.html">Access::Read&lt;ProductMatrix *&gt;</a> &amp;a) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">return</span> a.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1AccessGeneric.html#adcf2b692e27c42e30bfedea17d68a4bc">obj</a>-&gt;impl_get_const();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;}</div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#aebefb762a94879b583f0ab81d2f46a0b">  586</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(<a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopGlobalInfo</a> *global_info,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                        sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                        <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Write.html">Access::Write&lt;ProductMatrix *&gt;</a> &amp;a) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="keywordflow">return</span> a.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1AccessGeneric.html#adcf2b692e27c42e30bfedea17d68a4bc">obj</a>-&gt;impl_get();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#a2cf18f64a4f7ced48179a1b52c26108e">  594</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="structNESO_1_1Particles_1_1ProductMatrixGet.html">ProductMatrixGet</a> <a class="code" href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">create_loop_arg</a>(<a class="code" href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">ParticleLoopGlobalInfo</a> *global_info,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                        sycl::handler &amp;cgh,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                        <a class="code" href="structNESO_1_1Particles_1_1Access_1_1Add.html">Access::Add&lt;ProductMatrix *&gt;</a> &amp;a) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordflow">return</span> a.<a class="code" href="structNESO_1_1Particles_1_1Access_1_1AccessGeneric.html#adcf2b692e27c42e30bfedea17d68a4bc">obj</a>-&gt;impl_get();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;} <span class="comment">// namespace ParticleLoopImplementation</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;} <span class="comment">// namespace NESO::Particles</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1EventStack_html"><div class="ttname"><a href="classNESO_1_1Particles_1_1EventStack.html">NESO::Particles::EventStack</a></div><div class="ttdef"><b>Definition:</b> compute_target.hpp:684</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1EventStack_html_a6904b30365c9a305408d7db689487aa3"><div class="ttname"><a href="classNESO_1_1Particles_1_1EventStack.html#a6904b30365c9a305408d7db689487aa3">NESO::Particles::EventStack::wait</a></div><div class="ttdeci">void wait()</div><div class="ttdef"><b>Definition:</b> compute_target.hpp:704</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1EventStack_html_aee8a0be331891915bf8dccd4359aea20"><div class="ttname"><a href="classNESO_1_1Particles_1_1EventStack.html#aee8a0be331891915bf8dccd4359aea20">NESO::Particles::EventStack::push</a></div><div class="ttdeci">void push(sycl::event e)</div><div class="ttdef"><b>Definition:</b> compute_target.hpp:699</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ParticleGroup_html"><div class="ttname"><a href="classNESO_1_1Particles_1_1ParticleGroup.html">NESO::Particles::ParticleGroup</a></div><div class="ttdef"><b>Definition:</b> particle_group.hpp:84</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ParticleSpec_html"><div class="ttname"><a href="classNESO_1_1Particles_1_1ParticleSpec.html">NESO::Particles::ParticleSpec</a></div><div class="ttdef"><b>Definition:</b> particle_spec.hpp:79</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ParticleSpec_html_aa33c982494fe5adb6007f3daad7fb622"><div class="ttname"><a href="classNESO_1_1Particles_1_1ParticleSpec.html#aa33c982494fe5adb6007f3daad7fb622">NESO::Particles::ParticleSpec::properties_real</a></div><div class="ttdeci">std::vector&lt; ParticleProp&lt; REAL &gt; &gt; properties_real</div><div class="ttdoc">Collection of REAL ParticleProp.</div><div class="ttdef"><b>Definition:</b> particle_spec.hpp:110</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ParticleSpec_html_aeb5bac880755c38534d630b16de36004"><div class="ttname"><a href="classNESO_1_1Particles_1_1ParticleSpec.html#aeb5bac880755c38534d630b16de36004">NESO::Particles::ParticleSpec::properties_int</a></div><div class="ttdeci">std::vector&lt; ParticleProp&lt; INT &gt; &gt; properties_int</div><div class="ttdoc">Collection of INT ParticleProp.</div><div class="ttdef"><b>Definition:</b> particle_spec.hpp:112</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html">NESO::Particles::ProductMatrix</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:430</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a1e99906277466047744de32bd3be98bc"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a1e99906277466047744de32bd3be98bc">NESO::Particles::ProductMatrix::ProductMatrix</a></div><div class="ttdeci">ProductMatrix()=default</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a2e84197159db429c900407a9c2a046da"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a2e84197159db429c900407a9c2a046da">NESO::Particles::ProductMatrix::dh_offsets_int</a></div><div class="ttdeci">std::shared_ptr&lt; BufferDeviceHost&lt; int &gt; &gt; dh_offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:447</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a394ec9d622b553c346868a0e1cc47c9b"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a394ec9d622b553c346868a0e1cc47c9b">NESO::Particles::ProductMatrix::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdoc">The number of products stored.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:464</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a3bc081cdac6a89a5882917806845027c"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a3bc081cdac6a89a5882917806845027c">NESO::Particles::ProductMatrix::impl_get_const</a></div><div class="ttdeci">ProductMatrixGetConst impl_get_const()</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:454</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a4de28c1890fe75fe7dea47580a8eb920"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a4de28c1890fe75fe7dea47580a8eb920">NESO::Particles::ProductMatrix::d_data_real</a></div><div class="ttdeci">std::shared_ptr&lt; BufferDevice&lt; REAL &gt; &gt; d_data_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:444</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a7a85c983fe3d19e2a3a49fcd50db9ca1"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a7a85c983fe3d19e2a3a49fcd50db9ca1">NESO::Particles::ProductMatrix::impl_get</a></div><div class="ttdeci">ProductMatrixGet impl_get()</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:449</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a99922a29e95d64ce9e8db21626a87372"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a99922a29e95d64ce9e8db21626a87372">NESO::Particles::ProductMatrix::ProductMatrix</a></div><div class="ttdeci">ProductMatrix(SYCLTargetSharedPtr sycl_target, std::shared_ptr&lt; ProductMatrixSpec &gt; spec)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:484</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_a9fee81f0ff3286fc1f4c72a6dd928b8e"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#a9fee81f0ff3286fc1f4c72a6dd928b8e">NESO::Particles::ProductMatrix::operator=</a></div><div class="ttdeci">ProductMatrix &amp; operator=(const ProductMatrix &amp;)=default</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_aa1cab6680f0e17928d253ba02ebc581f"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#aa1cab6680f0e17928d253ba02ebc581f">NESO::Particles::ProductMatrix::reset</a></div><div class="ttdeci">virtual void reset(const int num_products)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:520</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_aa975aae565164248c7b6e902c1102bb1"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#aa975aae565164248c7b6e902c1102bb1">NESO::Particles::ProductMatrix::sycl_target</a></div><div class="ttdeci">SYCLTargetSharedPtr sycl_target</div><div class="ttdoc">The SYCLTarget products are created on.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:462</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_acd8862302e451df9bf66deacd64b3036"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#acd8862302e451df9bf66deacd64b3036">NESO::Particles::ProductMatrix::d_data_int</a></div><div class="ttdeci">std::shared_ptr&lt; BufferDevice&lt; INT &gt; &gt; d_data_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:445</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_ae42ded6981e0e85018ea7e619995aa88"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#ae42ded6981e0e85018ea7e619995aa88">NESO::Particles::ProductMatrix::dh_offsets_real</a></div><div class="ttdeci">std::shared_ptr&lt; BufferDeviceHost&lt; int &gt; &gt; dh_offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:446</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1ProductMatrix_html_aea1943c82462d28199426c4b6480cfd6"><div class="ttname"><a href="classNESO_1_1Particles_1_1ProductMatrix.html#aea1943c82462d28199426c4b6480cfd6">NESO::Particles::ProductMatrix::spec</a></div><div class="ttdeci">std::shared_ptr&lt; ProductMatrixSpec &gt; spec</div><div class="ttdoc">The specification of the products.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:466</div></div>
<div class="ttc" id="aclassNESO_1_1Particles_1_1Sym_html"><div class="ttname"><a href="classNESO_1_1Particles_1_1Sym.html">NESO::Particles::Sym&lt; INT &gt;</a></div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_1_1ParticleLoopImplementation_html_acc145e1ca44fcfde703b028c42a14b83"><div class="ttname"><a href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#acc145e1ca44fcfde703b028c42a14b83">NESO::Particles::ParticleLoopImplementation::create_loop_arg</a></div><div class="ttdeci">T *const  *const  * create_loop_arg(ParticleLoopGlobalInfo *global_info, sycl::handler &amp;cgh, Access::Read&lt; CellDat&lt; T &gt; * &gt; &amp;a)</div><div class="ttdef"><b>Definition:</b> cell_dat.hpp:97</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_1_1ParticleLoopImplementation_html_af4dcf9f325fb9449418a41ce0fc6d746"><div class="ttname"><a href="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation.html#af4dcf9f325fb9449418a41ce0fc6d746">NESO::Particles::ParticleLoopImplementation::create_kernel_arg</a></div><div class="ttdeci">void create_kernel_arg(ParticleLoopIteration &amp;iterationx, T *const *const *&amp;rhs, Access::CellDat::Read&lt; T &gt; &amp;lhs)</div><div class="ttdef"><b>Definition:</b> cell_dat.hpp:78</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html"><div class="ttname"><a href="namespaceNESO_1_1Particles.html">NESO::Particles</a></div><div class="ttdef"><b>Definition:</b> access.hpp:6</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html_a15dc55e8042484773cf877b8058eb67b"><div class="ttname"><a href="namespaceNESO_1_1Particles.html#a15dc55e8042484773cf877b8058eb67b">NESO::Particles::REAL</a></div><div class="ttdeci">double REAL</div><div class="ttdef"><b>Definition:</b> typedefs.hpp:112</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html_a4eac77e3de191a85cc05f4b1700cd605"><div class="ttname"><a href="namespaceNESO_1_1Particles.html#a4eac77e3de191a85cc05f4b1700cd605">NESO::Particles::INT</a></div><div class="ttdeci">int64_t INT</div><div class="ttdef"><b>Definition:</b> typedefs.hpp:113</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html_a897f23893a83614b3f78e2f08d7aad71"><div class="ttname"><a href="namespaceNESO_1_1Particles.html#a897f23893a83614b3f78e2f08d7aad71">NESO::Particles::SYCLTargetSharedPtr</a></div><div class="ttdeci">std::shared_ptr&lt; SYCLTarget &gt; SYCLTargetSharedPtr</div><div class="ttdef"><b>Definition:</b> compute_target.hpp:289</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html_a914c9c125729aade07b9ff53fa35d978"><div class="ttname"><a href="namespaceNESO_1_1Particles.html#a914c9c125729aade07b9ff53fa35d978">NESO::Particles::product_matrix</a></div><div class="ttdeci">std::shared_ptr&lt; ProductMatrix &gt; product_matrix(SYCLTargetSharedPtr sycl_target, std::shared_ptr&lt; ProductMatrixSpec &gt; spec)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:569</div></div>
<div class="ttc" id="anamespaceNESO_1_1Particles_html_aa6deabc4271b453cf01c32cac1a945fd"><div class="ttname"><a href="namespaceNESO_1_1Particles.html#aa6deabc4271b453cf01c32cac1a945fd">NESO::Particles::product_matrix_spec</a></div><div class="ttdeci">std::shared_ptr&lt; ProductMatrixSpec &gt; product_matrix_spec(ParticleSpec particle_spec)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:418</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1AccessGeneric_html_adcf2b692e27c42e30bfedea17d68a4bc"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1AccessGeneric.html#adcf2b692e27c42e30bfedea17d68a4bc">NESO::Particles::Access::AccessGeneric::obj</a></div><div class="ttdeci">T obj</div><div class="ttdef"><b>Definition:</b> access_descriptors.hpp:11</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1Add_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1Add.html">NESO::Particles::Access::Add</a></div><div class="ttdef"><b>Definition:</b> access_descriptors.hpp:26</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html">NESO::Particles::Access::ProductMatrix::Add</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:89</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a092f0b2f2ce70f1799a9773fabea88e3"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a092f0b2f2ce70f1799a9773fabea88e3">NESO::Particles::Access::ProductMatrix::Add::Add</a></div><div class="ttdeci">Add()=default</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a0b8bee33aa8a7dd349d12871f6f7a33d"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a0b8bee33aa8a7dd349d12871f6f7a33d">NESO::Particles::Access::ProductMatrix::Add::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:95</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a7a7e9b30db9274b11fe195df68f3f875"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a7a7e9b30db9274b11fe195df68f3f875">NESO::Particles::Access::ProductMatrix::Add::fetch_add_real</a></div><div class="ttdeci">REAL fetch_add_real(const int product, const int property, const int component, const REAL value)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:108</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a936654066f9d1c28c8f0cf5b71895d9b"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a936654066f9d1c28c8f0cf5b71895d9b">NESO::Particles::Access::ProductMatrix::Add::offsets_real</a></div><div class="ttdeci">int const  * offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:93</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a9aa679139ab41ab7933c70524373d475"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9aa679139ab41ab7933c70524373d475">NESO::Particles::Access::ProductMatrix::Add::offsets_int</a></div><div class="ttdeci">int const  * offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:94</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_a9c918c0a7f3803454be7e1fed082e9b7"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#a9c918c0a7f3803454be7e1fed082e9b7">NESO::Particles::Access::ProductMatrix::Add::ptr_real</a></div><div class="ttdeci">REAL * ptr_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:91</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_ae4d38dada5b74b84f9279e4bc5b7127a"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#ae4d38dada5b74b84f9279e4bc5b7127a">NESO::Particles::Access::ProductMatrix::Add::ptr_int</a></div><div class="ttdeci">INT * ptr_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:92</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add_html_aec8797408d6d3c99f8f4f5fbb2bf962c"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Add.html#aec8797408d6d3c99f8f4f5fbb2bf962c">NESO::Particles::Access::ProductMatrix::Add::fetch_add_int</a></div><div class="ttdeci">INT fetch_add_int(const int product, const int property, const int component, const INT value)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:129</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html">NESO::Particles::Access::ProductMatrix::Read</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:47</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_a109e69e77b81d0144db17443a1227c98"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a109e69e77b81d0144db17443a1227c98">NESO::Particles::Access::ProductMatrix::Read::offsets_real</a></div><div class="ttdeci">int const  * offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:51</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_a1c51f50f8a92ea3611498963257f3174"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a1c51f50f8a92ea3611498963257f3174">NESO::Particles::Access::ProductMatrix::Read::ptr_int</a></div><div class="ttdeci">INT const  * ptr_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:50</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_a3a6a280fcc226f9e7d2f2de5206ac0b3"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3a6a280fcc226f9e7d2f2de5206ac0b3">NESO::Particles::Access::ProductMatrix::Read::offsets_int</a></div><div class="ttdeci">int const  * offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:52</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_a3b2e41e70e358a3f3e3c9608f2bad802"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a3b2e41e70e358a3f3e3c9608f2bad802">NESO::Particles::Access::ProductMatrix::Read::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:53</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_a5a8bb615e2efca50b383a6bd1840baeb"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#a5a8bb615e2efca50b383a6bd1840baeb">NESO::Particles::Access::ProductMatrix::Read::Read</a></div><div class="ttdeci">Read()=default</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_aa4b3e9fa140498c5784103cc949c4275"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#aa4b3e9fa140498c5784103cc949c4275">NESO::Particles::Access::ProductMatrix::Read::at_int</a></div><div class="ttdeci">const INT &amp; at_int(const int product, const int property, const int component) const</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:79</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_acef5ea2a30b64a45035e739c18d73bef"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#acef5ea2a30b64a45035e739c18d73bef">NESO::Particles::Access::ProductMatrix::Read::ptr_real</a></div><div class="ttdeci">REAL const  * ptr_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:49</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read_html_ae59a3f0e8e1cfecdad0a520f27831002"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Read.html#ae59a3f0e8e1cfecdad0a520f27831002">NESO::Particles::Access::ProductMatrix::Read::at_real</a></div><div class="ttdeci">const REAL &amp; at_real(const int product, const int property, const int component) const</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:64</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html">NESO::Particles::Access::ProductMatrix::Write</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:143</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_a090627d1289b79d0b210a2cd801b4d17"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a090627d1289b79d0b210a2cd801b4d17">NESO::Particles::Access::ProductMatrix::Write::ptr_int</a></div><div class="ttdeci">INT * ptr_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:147</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_a509e7d32ab1a794ac559676b22bad978"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a509e7d32ab1a794ac559676b22bad978">NESO::Particles::Access::ProductMatrix::Write::at_real</a></div><div class="ttdeci">REAL &amp; at_real(const int product, const int property, const int component)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:162</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_a84911c8a18e14671a1bb5bab56f4483e"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a84911c8a18e14671a1bb5bab56f4483e">NESO::Particles::Access::ProductMatrix::Write::ptr_real</a></div><div class="ttdeci">REAL * ptr_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:146</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_a8be413685b28a0e67fbd287747b9292b"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a8be413685b28a0e67fbd287747b9292b">NESO::Particles::Access::ProductMatrix::Write::at_int</a></div><div class="ttdeci">INT &amp; at_int(const int product, const int property, const int component)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:177</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_a99796ac07983f837061a0431ceba2a83"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#a99796ac07983f837061a0431ceba2a83">NESO::Particles::Access::ProductMatrix::Write::offsets_real</a></div><div class="ttdeci">int const  * offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:148</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_abf7bbb38a2afed9d48b85cface0d92f6"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#abf7bbb38a2afed9d48b85cface0d92f6">NESO::Particles::Access::ProductMatrix::Write::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:150</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_ae3b26a8cd3f6e7e6810f7389c6f1159a"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#ae3b26a8cd3f6e7e6810f7389c6f1159a">NESO::Particles::Access::ProductMatrix::Write::offsets_int</a></div><div class="ttdeci">int const  * offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:149</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write_html_af23f6e0c2e44e5b874209cdbeb1d924f"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1ProductMatrix_1_1Write.html#af23f6e0c2e44e5b874209cdbeb1d924f">NESO::Particles::Access::ProductMatrix::Write::Write</a></div><div class="ttdeci">Write()=default</div><div class="ttdoc">Pointer to underlying data for the array.</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1Read_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1Read.html">NESO::Particles::Access::Read</a></div><div class="ttdef"><b>Definition:</b> access_descriptors.hpp:16</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1Access_1_1Write_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1Access_1_1Write.html">NESO::Particles::Access::Write</a></div><div class="ttdef"><b>Definition:</b> access_descriptors.hpp:21</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter.html">NESO::Particles::ParticleLoopImplementation::KernelParameter</a></div><div class="ttdef"><b>Definition:</b> particle_loop_base.hpp:27</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter.html">NESO::Particles::ParticleLoopImplementation::LoopParameter</a></div><div class="ttdef"><b>Definition:</b> particle_loop_base.hpp:21</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo.html">NESO::Particles::ParticleLoopImplementation::ParticleLoopGlobalInfo</a></div><div class="ttdef"><b>Definition:</b> particle_loop_base.hpp:33</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration.html">NESO::Particles::ParticleLoopImplementation::ParticleLoopIteration</a></div><div class="ttdef"><b>Definition:</b> particle_loop_base.hpp:45</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html">NESO::Particles::ProductMatrixGetConst</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:26</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html_a19384039656e013c133882369a7903eb"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a19384039656e013c133882369a7903eb">NESO::Particles::ProductMatrixGetConst::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:31</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html_a3d0ef94213054ab1ff3b247d15401a9a"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a3d0ef94213054ab1ff3b247d15401a9a">NESO::Particles::ProductMatrixGetConst::ptr_int</a></div><div class="ttdeci">INT const  * ptr_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:28</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html_a6b7948ee6a0f420eb2064e207e0bf7c6"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a6b7948ee6a0f420eb2064e207e0bf7c6">NESO::Particles::ProductMatrixGetConst::ptr_real</a></div><div class="ttdeci">REAL const  * ptr_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:27</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html_a7746eaa22c0e658a819ef028fcd36d25"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#a7746eaa22c0e658a819ef028fcd36d25">NESO::Particles::ProductMatrixGetConst::offsets_int</a></div><div class="ttdeci">int const  * offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:30</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGetConst_html_acdf3a3c4288178483f219b558350d87d"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGetConst.html#acdf3a3c4288178483f219b558350d87d">NESO::Particles::ProductMatrixGetConst::offsets_real</a></div><div class="ttdeci">int const  * offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:29</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html">NESO::Particles::ProductMatrixGet</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:18</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html_a27ecaa82dceb6278936325eb17307e5a"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a27ecaa82dceb6278936325eb17307e5a">NESO::Particles::ProductMatrixGet::offsets_real</a></div><div class="ttdeci">int const  * offsets_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:21</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html_a79dd138947ccaaedb1b6255561676301"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a79dd138947ccaaedb1b6255561676301">NESO::Particles::ProductMatrixGet::ptr_int</a></div><div class="ttdeci">INT * ptr_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:20</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html_a7a8e24db445e735a2c882bbfa31ddf07"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a7a8e24db445e735a2c882bbfa31ddf07">NESO::Particles::ProductMatrixGet::num_products</a></div><div class="ttdeci">int num_products</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:23</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html_a8c68504b405bda965b11c02d8a5087a2"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html#a8c68504b405bda965b11c02d8a5087a2">NESO::Particles::ProductMatrixGet::offsets_int</a></div><div class="ttdeci">int const  * offsets_int</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:22</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixGet_html_ac9e69f2a7f0c1a0e95891b20a26bd291"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixGet.html#ac9e69f2a7f0c1a0e95891b20a26bd291">NESO::Particles::ProductMatrixGet::ptr_real</a></div><div class="ttdeci">REAL * ptr_real</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:19</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html">NESO::Particles::ProductMatrixSpec</a></div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:272</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a158f2d9e91561033eccc01802cb09a24"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a158f2d9e91561033eccc01802cb09a24">NESO::Particles::ProductMatrixSpec::ProductMatrixSpec</a></div><div class="ttdeci">ProductMatrixSpec()=default</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a1a9616219ab019b6d7c749d6199c0cb9"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1a9616219ab019b6d7c749d6199c0cb9">NESO::Particles::ProductMatrixSpec::get_num_components</a></div><div class="ttdeci">int get_num_components(const Sym&lt; REAL &gt; sym)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:390</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a1e1e971fce76dee24f8b97331a91f328"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a1e1e971fce76dee24f8b97331a91f328">NESO::Particles::ProductMatrixSpec::map_sym_index_int</a></div><div class="ttdeci">std::map&lt; Sym&lt; INT &gt;, int &gt; map_sym_index_int</div><div class="ttdoc">Map from sym to integer index.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:296</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a2c52ff03bd412f9e1fddfa2eab35495f"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2c52ff03bd412f9e1fddfa2eab35495f">NESO::Particles::ProductMatrixSpec::set_default_value</a></div><div class="ttdeci">void set_default_value(Sym&lt; REAL &gt; sym, const int component, const REAL value)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:356</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a2d2ca1d16e2ac053c2a84e6523297f60"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a2d2ca1d16e2ac053c2a84e6523297f60">NESO::Particles::ProductMatrixSpec::num_properties_int</a></div><div class="ttdeci">int num_properties_int</div><div class="ttdoc">The number of INT particle properties.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:280</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a32a2d4fdf26bd2e56d3e0eecec888eb6"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a32a2d4fdf26bd2e56d3e0eecec888eb6">NESO::Particles::ProductMatrixSpec::get_sym_index</a></div><div class="ttdeci">int get_sym_index(const Sym&lt; INT &gt; sym) const</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:378</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a4553b2c502650c65d4c4db1bcc9f3c7f"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a4553b2c502650c65d4c4db1bcc9f3c7f">NESO::Particles::ProductMatrixSpec::default_values_real</a></div><div class="ttdeci">std::map&lt; std::pair&lt; Sym&lt; REAL &gt;, int &gt;, REAL &gt; default_values_real</div><div class="ttdoc">Default values applied on call to reset for REAL.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:290</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a5dfc076cb0df6971d26a272813af1fb1"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a5dfc076cb0df6971d26a272813af1fb1">NESO::Particles::ProductMatrixSpec::ProductMatrixSpec</a></div><div class="ttdeci">ProductMatrixSpec(ParticleSpec &amp;particle_spec)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:309</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a60cbd37a27921801cf7114e34fcfa029"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a60cbd37a27921801cf7114e34fcfa029">NESO::Particles::ProductMatrixSpec::num_properties_real</a></div><div class="ttdeci">int num_properties_real</div><div class="ttdoc">The number of REAL particle properties.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:278</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a71678c9c640af008237c72b7b4031f29"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a71678c9c640af008237c72b7b4031f29">NESO::Particles::ProductMatrixSpec::map_sym_index_real</a></div><div class="ttdeci">std::map&lt; Sym&lt; REAL &gt;, int &gt; map_sym_index_real</div><div class="ttdoc">Map from sym to integer index.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:294</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a7d894ef4cd7fe3bac8bf0c44cd53b7ab"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a7d894ef4cd7fe3bac8bf0c44cd53b7ab">NESO::Particles::ProductMatrixSpec::particle_spec</a></div><div class="ttdeci">ParticleSpec particle_spec</div><div class="ttdoc">The ParticleSpec the instance was created from.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:299</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a832cc86477fee3843edcd029398007d3"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a832cc86477fee3843edcd029398007d3">NESO::Particles::ProductMatrixSpec::get_num_components</a></div><div class="ttdeci">int get_num_components(const Sym&lt; INT &gt; sym)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:402</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a9a7054fdc1b3a2474181858351e412bc"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9a7054fdc1b3a2474181858351e412bc">NESO::Particles::ProductMatrixSpec::num_components_int</a></div><div class="ttdeci">int num_components_int</div><div class="ttdoc">The total number of components of type INT stored.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:276</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a9b2431397961c923f4f58ad08159a699"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b2431397961c923f4f58ad08159a699">NESO::Particles::ProductMatrixSpec::components_real</a></div><div class="ttdeci">std::vector&lt; int &gt; components_real</div><div class="ttdoc">The number of components per output property for REAL.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:286</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a9b402151bc42788762a21a3439ff0604"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9b402151bc42788762a21a3439ff0604">NESO::Particles::ProductMatrixSpec::set_default_value</a></div><div class="ttdeci">void set_default_value(Sym&lt; INT &gt; sym, const int component, const INT value)</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:344</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_a9f1269bcfdbc18f0ebdd1b4ad1c29d55"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#a9f1269bcfdbc18f0ebdd1b4ad1c29d55">NESO::Particles::ProductMatrixSpec::default_values_int</a></div><div class="ttdeci">std::map&lt; std::pair&lt; Sym&lt; INT &gt;, int &gt;, INT &gt; default_values_int</div><div class="ttdoc">Default values applied on call to reset for INT.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:292</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_ac72e1a4ad5464c7b97678c02c0af32ad"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ac72e1a4ad5464c7b97678c02c0af32ad">NESO::Particles::ProductMatrixSpec::syms_real</a></div><div class="ttdeci">std::vector&lt; Sym&lt; REAL &gt; &gt; syms_real</div><div class="ttdoc">The vector of REAL Syms.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:282</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_acdb63dc057ce80cd35ec56d1f9be8b03"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#acdb63dc057ce80cd35ec56d1f9be8b03">NESO::Particles::ProductMatrixSpec::get_sym_index</a></div><div class="ttdeci">int get_sym_index(const Sym&lt; REAL &gt; sym) const</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:365</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_ad9ff6164237eb6d74171549702fff442"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ad9ff6164237eb6d74171549702fff442">NESO::Particles::ProductMatrixSpec::components_int</a></div><div class="ttdeci">std::vector&lt; int &gt; components_int</div><div class="ttdoc">The number of components per output property for INT.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:288</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_ae273bdefefb8f958d4bf4cb7a0c7a7b5"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae273bdefefb8f958d4bf4cb7a0c7a7b5">NESO::Particles::ProductMatrixSpec::num_components_real</a></div><div class="ttdeci">int num_components_real</div><div class="ttdoc">The total number of components of type REAL stored.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:274</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_ae9072103019d477721f463db865f1dc4"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#ae9072103019d477721f463db865f1dc4">NESO::Particles::ProductMatrixSpec::operator=</a></div><div class="ttdeci">ProductMatrixSpec &amp; operator=(const ProductMatrixSpec &amp;)=default</div></div>
<div class="ttc" id="astructNESO_1_1Particles_1_1ProductMatrixSpec_html_aea4cc983e388d36ebb3ab47d02e2713d"><div class="ttname"><a href="structNESO_1_1Particles_1_1ProductMatrixSpec.html#aea4cc983e388d36ebb3ab47d02e2713d">NESO::Particles::ProductMatrixSpec::syms_int</a></div><div class="ttdeci">std::vector&lt; Sym&lt; INT &gt; &gt; syms_int</div><div class="ttdoc">The vector of INT Syms.</div><div class="ttdef"><b>Definition:</b> product_matrix.hpp:284</div></div>
<div class="ttc" id="atypedefs_8hpp_html_ac780e64fe76ab7e5f6b07c55de92d018"><div class="ttname"><a href="typedefs_8hpp.html#ac780e64fe76ab7e5f6b07c55de92d018">NESOASSERT</a></div><div class="ttdeci">#define NESOASSERT(expr, msg)</div><div class="ttdef"><b>Definition:</b> typedefs.hpp:31</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
