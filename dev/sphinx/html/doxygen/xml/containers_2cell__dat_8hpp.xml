<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="containers_2cell__dat_8hpp" kind="file" language="C++">
    <compoundname>cell_dat.hpp</compoundname>
    <includes refid="particle__loop__base_8hpp" local="yes">../loop/particle_loop_base.hpp</includes>
    <includes refid="cell__data_8hpp" local="yes">cell_data.hpp</includes>
    <includedby refid="cell__dat_8hpp" local="yes">/tmp/repo-checkout/NESO-Particles/include/cell_dat.hpp</includedby>
    <incdepgraph>
      <node id="20">
        <label>access_descriptors.hpp</label>
        <link refid="access__descriptors_8hpp"/>
      </node>
      <node id="3">
        <label>../compute_target.hpp</label>
        <link refid="compute__target_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>CL/sycl.hpp</label>
      </node>
      <node id="15">
        <label>cstdint</label>
      </node>
      <node id="17">
        <label>numeric</label>
      </node>
      <node id="10">
        <label>string</label>
      </node>
      <node id="7">
        <label>map</label>
      </node>
      <node id="18">
        <label>profiling.hpp</label>
        <link refid="profiling_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>optional</label>
      </node>
      <node id="11">
        <label>vector</label>
      </node>
      <node id="9">
        <label>stack</label>
      </node>
      <node id="12">
        <label>communication.hpp</label>
        <link refid="communication_8hpp"/>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>array</label>
      </node>
      <node id="13">
        <label>typedefs.hpp</label>
        <link refid="typedefs_8hpp"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>cstdlib</label>
      </node>
      <node id="16">
        <label>iostream</label>
      </node>
      <node id="23">
        <label>cell_data.hpp</label>
        <link refid="cell__data_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>chrono</label>
      </node>
      <node id="8">
        <label>mpi.h</label>
      </node>
      <node id="1">
        <label>/tmp/repo-checkout/NESO-Particles/include/containers/cell_dat.hpp</label>
        <link refid="containers_2cell__dat_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>algorithm</label>
      </node>
      <node id="21">
        <label>memory</label>
      </node>
      <node id="2">
        <label>../loop/particle_loop_base.hpp</label>
        <link refid="particle__loop__base_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="15">
        <label>/tmp/repo-checkout/NESO-Particles/include/parallel_initialisation.hpp</label>
        <link refid="parallel__initialisation_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="20">
        <label>/tmp/repo-checkout/NESO-Particles/include/containers/descendant_products.hpp</label>
        <link refid="descendant__products_8hpp"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>/tmp/repo-checkout/NESO-Particles/include/global_move.hpp</label>
        <link refid="global__move_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>/tmp/repo-checkout/NESO-Particles/include/loop/particle_loop.hpp</label>
        <link refid="particle__loop_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="8">
        <label>/tmp/repo-checkout/NESO-Particles/include/cartesian_mesh.hpp</label>
        <link refid="cartesian__mesh_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="29">
        <label>/tmp/repo-checkout/NESO-Particles/include/local_mapping.hpp</label>
        <link refid="local__mapping_8hpp"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>/tmp/repo-checkout/NESO-Particles/include/cell_dat_move.hpp</label>
        <link refid="cell__dat__move_8hpp"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>/tmp/repo-checkout/NESO-Particles/include/departing_particle_identification_impl.hpp</label>
        <link refid="departing__particle__identification__impl_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>/tmp/repo-checkout/NESO-Particles/include/global_move_exchange.hpp</label>
        <link refid="global__move__exchange_8hpp"/>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="12">
        <label>/tmp/repo-checkout/NESO-Particles/include/boundary_conditions.hpp</label>
        <link refid="boundary__conditions_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>/tmp/repo-checkout/NESO-Particles/include/neso_particles.hpp</label>
        <link refid="neso__particles_8hpp"/>
      </node>
      <node id="9">
        <label>/tmp/repo-checkout/NESO-Particles/include/containers/sym_vector.hpp</label>
        <link refid="sym__vector_8hpp"/>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="30">
        <label>/tmp/repo-checkout/NESO-Particles/include/packing_unpacking.hpp</label>
        <link refid="packing__unpacking_8hpp"/>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>/tmp/repo-checkout/NESO-Particles/include/global_mapping_impl.hpp</label>
        <link refid="global__mapping__impl_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>/tmp/repo-checkout/NESO-Particles/include/cell_dat_compression.hpp</label>
        <link refid="cell__dat__compression_8hpp"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_group.hpp</label>
        <link refid="particle__group_8hpp"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_dat.hpp</label>
        <link refid="particle__dat_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>/tmp/repo-checkout/NESO-Particles/include/cell_dat_move_impl.hpp</label>
        <link refid="cell__dat__move__impl_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>/tmp/repo-checkout/NESO-Particles/include/loop/particle_loop_index.hpp</label>
        <link refid="particle__loop__index_8hpp"/>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="26">
        <label>/tmp/repo-checkout/NESO-Particles/include/departing_particle_identification.hpp</label>
        <link refid="departing__particle__identification_8hpp"/>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>/tmp/repo-checkout/NESO-Particles/include/cell_dat.hpp</label>
        <link refid="cell__dat_8hpp"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>/tmp/repo-checkout/NESO-Particles/include/loop/pli_particle_dat.hpp</label>
        <link refid="pli__particle__dat_8hpp"/>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>/tmp/repo-checkout/NESO-Particles/include/cell_binning.hpp</label>
        <link refid="cell__binning_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_remover.hpp</label>
        <link refid="particle__remover_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_group_impl.hpp</label>
        <link refid="particle__group__impl_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>/tmp/repo-checkout/NESO-Particles/include/local_move.hpp</label>
        <link refid="local__move_8hpp"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_sub_group.hpp</label>
        <link refid="particle__sub__group_8hpp"/>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>/tmp/repo-checkout/NESO-Particles/include/containers/cell_dat.hpp</label>
        <link refid="containers_2cell__dat_8hpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="28">
        <label>/tmp/repo-checkout/NESO-Particles/include/global_mapping.hpp</label>
        <link refid="global__mapping_8hpp"/>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>/tmp/repo-checkout/NESO-Particles/include/particle_io.hpp</label>
        <link refid="particle__io_8hpp"/>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>/tmp/repo-checkout/NESO-Particles/include/domain.hpp</label>
        <link refid="domain_8hpp"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" prot="public">NESO::Particles::Access::CellDat::Read</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" prot="public">NESO::Particles::Access::CellDat::Add</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" prot="public">NESO::Particles::Access::CellDat::Write</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::LoopParameter&lt; Access::Read&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::LoopParameter&lt; Access::Write&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::LoopParameter&lt; Access::Add&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::KernelParameter&lt; Access::Read&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::KernelParameter&lt; Access::Write&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4" prot="public">NESO::Particles::ParticleLoopImplementation::KernelParameter&lt; Access::Add&lt; CellDat&lt; T &gt; &gt; &gt;</innerclass>
    <innerclass refid="classNESO_1_1Particles_1_1CellDat" prot="public">NESO::Particles::CellDat</innerclass>
    <innernamespace refid="namespaceNESO">NESO</innernamespace>
    <innernamespace refid="namespaceNESO_1_1Particles">NESO::Particles</innernamespace>
    <innernamespace refid="namespaceNESO_1_1Particles_1_1Access">NESO::Particles::Access</innernamespace>
    <innernamespace refid="namespaceNESO_1_1Particles_1_1Access_1_1CellDat">NESO::Particles::Access::CellDat</innernamespace>
    <innernamespace refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation">NESO::Particles::ParticleLoopImplementation</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="preprocessor">#ifndef<sp/>_NESO_PARTICLES_CELL_DAT_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>_NESO_PARTICLES_CELL_DAT_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;../loop/particle_loop_base.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cell__data_8hpp" kindref="compound">cell_data.hpp</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceNESO_1_1Particles" kindref="compound">NESO::Particles</ref><sp/>{</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">ParticlePacker;</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">CellDat;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="namespaceNESO_1_1Particles_1_1Access" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">Access::CellDat<sp/>{</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="20" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" kindref="compound">Read</ref><sp/>{</highlight></codeline>
<codeline lineno="22" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1aefef3231d82d2ba9dbcb1ee432c31684" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1aefef3231d82d2ba9dbcb1ee432c31684" kindref="member">Read</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="23" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ab8fd50db1ca8a4cec340e9d0a57c7740" refkind="member"><highlight class="normal"><sp/><sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ab8fd50db1ca8a4cec340e9d0a57c7740" kindref="member">ptr</ref>;</highlight></codeline>
<codeline lineno="24" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ad593598f7cc3b57b541799afef9c161e" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ad593598f7cc3b57b541799afef9c161e" kindref="member">cell</ref>;</highlight></codeline>
<codeline lineno="25" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1aa4a2d57eb01f4a77fc47858e952577ce" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1aa4a2d57eb01f4a77fc47858e952577ce" kindref="member">at</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col)<sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ab8fd50db1ca8a4cec340e9d0a57c7740" kindref="member">ptr</ref>[<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ad593598f7cc3b57b541799afef9c161e" kindref="member">cell</ref>][col][row];</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="28"><highlight class="normal">};</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="33" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" kindref="compound">Add</ref><sp/>{</highlight></codeline>
<codeline lineno="35" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a26872f3cbd8121df2cb59979e9204941" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a26872f3cbd8121df2cb59979e9204941" kindref="member">Add</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="36" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1ae4ec4e546f73b210f8833aa53bb9e76c" refkind="member"><highlight class="normal"><sp/><sp/>T<sp/>***<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1ae4ec4e546f73b210f8833aa53bb9e76c" kindref="member">ptr</ref>;</highlight></codeline>
<codeline lineno="37" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a4a7c8d1a2319d60c276e1f05fbc795e7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a4a7c8d1a2319d60c276e1f05fbc795e7" kindref="member">cell</ref>;</highlight></codeline>
<codeline lineno="38" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1adbac1240ec76002e91f9527f1ddc720a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1adbac1240ec76002e91f9527f1ddc720a" kindref="member">fetch_add</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>value)<sp/>{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>sycl::atomic_ref&lt;T,<sp/>sycl::memory_order::relaxed,<sp/>sycl::memory_scope::device&gt;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element_atomic(<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1ae4ec4e546f73b210f8833aa53bb9e76c" kindref="member">ptr</ref>[<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a4a7c8d1a2319d60c276e1f05fbc795e7" kindref="member">cell</ref>][col][row]);</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>element_atomic.fetch_add(value);</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="43"><highlight class="normal">};</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" kindref="compound">Write</ref><sp/>{</highlight></codeline>
<codeline lineno="50" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a7c360794ec12fa238cd6ddbfd8fbf5a2" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a7c360794ec12fa238cd6ddbfd8fbf5a2" kindref="member">Write</ref>()<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="51" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a00cb8eeedafde656f3936df8c30d4eb1" refkind="member"><highlight class="normal"><sp/><sp/>T<sp/>***<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a00cb8eeedafde656f3936df8c30d4eb1" kindref="member">ptr</ref>;</highlight></codeline>
<codeline lineno="52" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a9097313772272529dd9d12451a70516a" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a9097313772272529dd9d12451a70516a" kindref="member">cell</ref>;</highlight></codeline>
<codeline lineno="53" refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1aba3dee672e8faacbd784e2eb41520f16" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>&amp;<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1aba3dee672e8faacbd784e2eb41520f16" kindref="member">at</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a00cb8eeedafde656f3936df8c30d4eb1" kindref="member">ptr</ref>[<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a9097313772272529dd9d12451a70516a" kindref="member">cell</ref>][col][row];<sp/>}</highlight></codeline>
<codeline lineno="54"><highlight class="normal">};</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>Access::CellDat</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">ParticleLoopImplementation<sp/>{</highlight></codeline>
<codeline lineno="59" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter" kindref="compound">LoopParameter</ref>&lt;Access::Read&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="60" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4_1aa2fe294ff14f3e1862f234bcf5aaacff" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4_1aa2fe294ff14f3e1862f234bcf5aaacff" kindref="member">type</ref><sp/>=<sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*;</highlight></codeline>
<codeline lineno="61"><highlight class="normal">};</highlight></codeline>
<codeline lineno="62" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter" kindref="compound">LoopParameter</ref>&lt;Access::Write&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="63" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4_1aac9b4282da918fe5b102cdf7df126a1b" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4_1aac9b4282da918fe5b102cdf7df126a1b" kindref="member">type</ref><sp/>=<sp/>T<sp/>***;</highlight></codeline>
<codeline lineno="64"><highlight class="normal">};</highlight></codeline>
<codeline lineno="65" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter" kindref="compound">LoopParameter</ref>&lt;Access::Add&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="66" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4_1a0d7502994271cf538457ef31e3866e71" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1LoopParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4_1a0d7502994271cf538457ef31e3866e71" kindref="member">type</ref><sp/>=<sp/>T<sp/>***;</highlight></codeline>
<codeline lineno="67"><highlight class="normal">};</highlight></codeline>
<codeline lineno="68" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter" kindref="compound">KernelParameter</ref>&lt;Access::Read&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="69" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Read_3_01CellDat_3_01T_01_4_01_4_01_4_1a24149c94cd86fc021b3b171f26853594" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" kindref="compound">type</ref><sp/>=<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" kindref="compound">Access::CellDat::Read&lt;T&gt;</ref>;</highlight></codeline>
<codeline lineno="70"><highlight class="normal">};</highlight></codeline>
<codeline lineno="71" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter" kindref="compound">KernelParameter</ref>&lt;Access::Write&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="72" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Write_3_01CellDat_3_01T_01_4_01_4_01_4_1ac3cbf4efb9ac78fff4dfc2c06f225d99" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" kindref="compound">type</ref><sp/>=<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" kindref="compound">Access::CellDat::Write&lt;T&gt;</ref>;</highlight></codeline>
<codeline lineno="73"><highlight class="normal">};</highlight></codeline>
<codeline lineno="74" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter" kindref="compound">KernelParameter</ref>&lt;Access::Add&lt;CellDat&lt;T&gt;&gt;&gt;<sp/>{</highlight></codeline>
<codeline lineno="75" refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1KernelParameter_3_01Access_1_1Add_3_01CellDat_3_01T_01_4_01_4_01_4_1ab85b8707b14a9f218b2490caa7fdf8fe" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" kindref="compound">type</ref><sp/>=<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" kindref="compound">Access::CellDat::Add&lt;T&gt;</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal">};</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="78" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1af4dcf9f325fb9449418a41ce0fc6d746" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1af4dcf9f325fb9449418a41ce0fc6d746" kindref="member">create_kernel_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration" kindref="compound">ParticleLoopIteration</ref><sp/>&amp;iterationx,</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*&amp;rhs,</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read" kindref="compound">Access::CellDat::Read&lt;T&gt;</ref><sp/>&amp;lhs)<sp/>{</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ab8fd50db1ca8a4cec340e9d0a57c7740" kindref="member">ptr</ref><sp/>=<sp/>rhs;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Read_1ad593598f7cc3b57b541799afef9c161e" kindref="member">cell</ref><sp/>=<sp/>iterationx.<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration_1a7fab228d88184acd657deb68b6d6610d" kindref="member">cellx</ref>;</highlight></codeline>
<codeline lineno="83"><highlight class="normal">}</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="85" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1a2ddb94fa3d6e90364acadde4ff462aa7" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1af4dcf9f325fb9449418a41ce0fc6d746" kindref="member">create_kernel_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration" kindref="compound">ParticleLoopIteration</ref><sp/>&amp;iterationx,<sp/>T<sp/>***&amp;rhs,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write" kindref="compound">Access::CellDat::Write&lt;T&gt;</ref><sp/>&amp;lhs)<sp/>{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a00cb8eeedafde656f3936df8c30d4eb1" kindref="member">ptr</ref><sp/>=<sp/>rhs;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Write_1a9097313772272529dd9d12451a70516a" kindref="member">cell</ref><sp/>=<sp/>iterationx.<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration_1a7fab228d88184acd657deb68b6d6610d" kindref="member">cellx</ref>;</highlight></codeline>
<codeline lineno="89"><highlight class="normal">}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="91" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1a836a23d148eb7e144131d5b643916341" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1af4dcf9f325fb9449418a41ce0fc6d746" kindref="member">create_kernel_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration" kindref="compound">ParticleLoopIteration</ref><sp/>&amp;iterationx,<sp/>T<sp/>***&amp;rhs,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add" kindref="compound">Access::CellDat::Add&lt;T&gt;</ref><sp/>&amp;lhs)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1ae4ec4e546f73b210f8833aa53bb9e76c" kindref="member">ptr</ref><sp/>=<sp/>rhs;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/>lhs.<ref refid="structNESO_1_1Particles_1_1Access_1_1CellDat_1_1Add_1a4a7c8d1a2319d60c276e1f05fbc795e7" kindref="member">cell</ref><sp/>=<sp/>iterationx.<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopIteration_1a7fab228d88184acd657deb68b6d6610d" kindref="member">cellx</ref>;</highlight></codeline>
<codeline lineno="95"><highlight class="normal">}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="97" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1acc145e1ca44fcfde703b028c42a14b83" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*<ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1acc145e1ca44fcfde703b028c42a14b83" kindref="member">create_loop_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Read" kindref="compound">Access::Read</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>a.obj-&gt;impl_get_const();</highlight></codeline>
<codeline lineno="101"><highlight class="normal">}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="103" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1aab5251da774539dd1f7678ad5aaca365" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>***<ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1acc145e1ca44fcfde703b028c42a14b83" kindref="member">create_loop_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Write" kindref="compound">Access::Write</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a)<sp/>{</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>a.obj-&gt;impl_get();</highlight></codeline>
<codeline lineno="107"><highlight class="normal">}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="109" refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1acf798758bf7203b99063a36920c3e45d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>***<ref refid="namespaceNESO_1_1Particles_1_1ParticleLoopImplementation_1acc145e1ca44fcfde703b028c42a14b83" kindref="member">create_loop_arg</ref>(<ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Add" kindref="compound">Access::Add</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>a.obj-&gt;impl_get();</highlight></codeline>
<codeline lineno="112"><highlight class="normal">}</highlight></codeline>
<codeline lineno="113"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>ParticleLoopImplementation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="120" refid="classNESO_1_1Particles_1_1CellDat" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;<sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat</ref><sp/>{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>allows<sp/>the<sp/>ParticleLoop<sp/>to<sp/>access<sp/>the<sp/>implementation<sp/>methods.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122" refid="classNESO_1_1Particles_1_1CellDat_1a5781ba095359438118ce96e2e0eb4a8d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>KERNEL,<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal">...<sp/>ARGS&gt;<sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classNESO_1_1Particles_1_1ParticleLoop" kindref="compound">ParticleLoop</ref>;</highlight></codeline>
<codeline lineno="123" refid="classNESO_1_1Particles_1_1CellDat_1aa4fb022a9ad9ded119a97287451ec8c9" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>U&gt;<sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classNESO_1_1Particles_1_1ParticleDatT" kindref="compound">ParticleDatT</ref>;</highlight></codeline>
<codeline lineno="124" refid="classNESO_1_1Particles_1_1CellDat_1a819c6dac82cd885c868f2409c6ee0d68" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classNESO_1_1Particles_1_1ParticlePacker" kindref="compound">ParticlePacker</ref>;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="classNESO_1_1Particles_1_1CellDat_1aa72143ed40cb68d4e48296c786eb18f5" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/>T<sp/>***ParticleLoopImplementation::create_loop_arg&lt;T&gt;(</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopImplementation::ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Add" kindref="compound">Access::Add</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a);</highlight></codeline>
<codeline lineno="129" refid="classNESO_1_1Particles_1_1CellDat_1aafc5f62aa6a95170cf0dc2a6d87bbfbf" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/>T<sp/>***ParticleLoopImplementation::create_loop_arg&lt;T&gt;(</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopImplementation::ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Write" kindref="compound">Access::Write</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a);</highlight></codeline>
<codeline lineno="132" refid="classNESO_1_1Particles_1_1CellDat_1aaf3bff49111ed62e4f2ed17cc75c57dc" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">friend</highlight><highlight class="normal"><sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*ParticleLoopImplementation::create_loop_arg&lt;T&gt;(</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structNESO_1_1Particles_1_1ParticleLoopImplementation_1_1ParticleLoopGlobalInfo" kindref="compound">ParticleLoopImplementation::ParticleLoopGlobalInfo</ref><sp/>*global_info,</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sycl::handler<sp/>&amp;cgh,<sp/><ref refid="structNESO_1_1Particles_1_1Access_1_1Read" kindref="compound">Access::Read</ref>&lt;<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat&lt;T&gt;</ref><sp/>*&gt;<sp/>&amp;a);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/>T<sp/>***d_ptr;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/>std::vector&lt;T<sp/>**&gt;<sp/>h_ptr_cells;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/>std::vector&lt;T<sp/>*&gt;<sp/>h_ptr_cols;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nrow_max<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nrow_min<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><ref refid="classNESO_1_1Particles_1_1EventStack" kindref="compound">EventStack</ref><sp/>stack_events;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/>std::stack&lt;T<sp/>*&gt;<sp/>stack_ptrs;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="keyword">protected</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="147" refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" refkind="member"><highlight class="normal"><sp/><sp/>std::function&lt;void(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)&gt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" kindref="member">write_callback</ref>;</highlight></codeline>
<codeline lineno="148" refid="classNESO_1_1Particles_1_1CellDat_1ae1275dd86b7cbef489efddf0b98ae487" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ae1275dd86b7cbef489efddf0b98ae487" kindref="member">add_write_callback</ref>(std::function&lt;</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)&gt;<sp/>fn)<sp/>{</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;write_callback<sp/>=<sp/>fn;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight></codeline>
<codeline lineno="156" refid="classNESO_1_1Particles_1_1CellDat_1a90c7eb7f37c2f6fe5a000d2e68cc7b33" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>***<ref refid="classNESO_1_1Particles_1_1CellDat_1a90c7eb7f37c2f6fe5a000d2e68cc7b33" kindref="member">impl_get</ref>()<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;write_callback)<sp/>{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" kindref="member">write_callback</ref>(0);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;d_ptr;</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="167" refid="classNESO_1_1Particles_1_1CellDat_1adb25dad88bd85d43bd95ed89b18402ef" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*<ref refid="classNESO_1_1Particles_1_1CellDat_1adb25dad88bd85d43bd95ed89b18402ef" kindref="member">impl_get_const</ref>()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;d_ptr;<sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="classNESO_1_1Particles_1_1CellDat_1aabd661d502c996945f0523075f04f856" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/>*<ref refid="classNESO_1_1Particles_1_1CellDat_1aabd661d502c996945f0523075f04f856" kindref="member">col_device_ptr</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col)<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref><sp/>+<sp/>col];</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="182" refid="classNESO_1_1Particles_1_1CellDat_1a1612409d20c89d5d2f4f96d9a9246f4b" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a1612409d20c89d5d2f4f96d9a9246f4b" kindref="member">CellDat</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat</ref><sp/>&amp;st)<sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="184" refid="classNESO_1_1Particles_1_1CellDat_1a2838258a95f1d5b8784578e4c81e2698" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat</ref><sp/>&amp;<ref refid="classNESO_1_1Particles_1_1CellDat_1a2838258a95f1d5b8784578e4c81e2698" kindref="member">operator=</ref>(<ref refid="classNESO_1_1Particles_1_1CellDat" kindref="compound">CellDat</ref><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>&amp;a)<sp/>=<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="187" refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1a897f23893a83614b3f78e2f08d7aad71" kindref="member">SYCLTargetSharedPtr</ref><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>;</highlight></codeline>
<codeline lineno="189" refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>;</highlight></codeline>
<codeline lineno="191" refid="classNESO_1_1Particles_1_1CellDat_1adf2f33e82dcd4856a767208d57dc1983" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;INT&gt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1adf2f33e82dcd4856a767208d57dc1983" kindref="member">nrow</ref>;</highlight></codeline>
<codeline lineno="193" refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;</highlight></codeline>
<codeline lineno="195" refid="classNESO_1_1Particles_1_1CellDat_1a47aea2900fd6a7a9a76f23aa82cfb69b" refkind="member"><highlight class="normal"><sp/><sp/>std::vector&lt;INT&gt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a47aea2900fd6a7a9a76f23aa82cfb69b" kindref="member">nrow_alloc</ref>;</highlight></codeline>
<codeline lineno="196" refid="classNESO_1_1Particles_1_1CellDat_1a6802b4fe170b6b672e500d9a8c43c029" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6802b4fe170b6b672e500d9a8c43c029" kindref="member">~CellDat</ref>()<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cellx<sp/>=<sp/>0;<sp/>cellx<sp/>&lt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>;<sp/>cellx++)<sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;free(this-&gt;h_ptr_cells[cellx]);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref><sp/>*<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;h_ptr_cols[colx]<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;free(this-&gt;h_ptr_cols[colx]);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;free(this-&gt;d_ptr);</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="216" refid="classNESO_1_1Particles_1_1CellDat_1a8223d8fa58e271af716380574355f0d7" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a8223d8fa58e271af716380574355f0d7" kindref="member">CellDat</ref>(<ref refid="namespaceNESO_1_1Particles_1a897f23893a83614b3f78e2f08d7aad71" kindref="member">SYCLTargetSharedPtr</ref><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>,</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>)</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>(<ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>),<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>),<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>(<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>),<sp/>nrow_max(0)<sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;nrow<sp/>=<sp/>std::vector&lt;INT&gt;(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;d_ptr<sp/>=</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(T<sp/>***)this-&gt;sycl_target-&gt;malloc_device(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T<sp/>**));</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cells<sp/>=<sp/>std::vector&lt;T<sp/>**&gt;(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols<sp/>=<sp/>std::vector&lt;T<sp/>*&gt;(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref><sp/>*<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;nrow_alloc<sp/>=<sp/>std::vector&lt;INT&gt;(<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cellx<sp/>=<sp/>0;<sp/>cellx<sp/>&lt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>;<sp/>cellx++)<sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow_alloc[cellx]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow[cellx]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cells[cellx]<sp/>=</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(T<sp/>**)this-&gt;sycl_target-&gt;malloc_device(<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T<sp/>*));</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cellx<sp/>*<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref><sp/>+<sp/>colx]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;queue.memcpy(d_ptr,<sp/>this-&gt;h_ptr_cells.data(),</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T<sp/>*));</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue.wait();</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="249" refid="classNESO_1_1Particles_1_1CellDat_1ac3541457758308f4b979ff270fde8794" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ac3541457758308f4b979ff270fde8794" kindref="member">set_nrow</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1a4eac77e3de191a85cc05f4b1700cd605" kindref="member">INT</ref><sp/>cell,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1a4eac77e3de191a85cc05f4b1700cd605" kindref="member">INT</ref><sp/>nrow_required)<sp/>{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>();</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell<sp/>&gt;=<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;Cell<sp/>index<sp/>is<sp/>negative&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Cell<sp/>index<sp/>is<sp/>&gt;=<sp/>ncells&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(nrow_required<sp/>&gt;=<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;Requested<sp/>number<sp/>of<sp/>rows<sp/>is<sp/>negative&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nrow_required<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1adf2f33e82dcd4856a767208d57dc1983" kindref="member">nrow</ref>[cell])<sp/>{</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow[cell]<sp/>=<sp/>nrow_required;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow_max<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;set_nrow&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1a4eac77e3de191a85cc05f4b1700cd605" kindref="member">INT</ref><sp/>nrow_alloced<sp/>=<sp/>this-&gt;nrow_alloc[cell];</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1a4eac77e3de191a85cc05f4b1700cd605" kindref="member">INT</ref><sp/>nrow_existing<sp/>=<sp/>this-&gt;nrow[cell];</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nrow_required<sp/>!=<sp/>nrow_existing)<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nrow_required<sp/>&gt;<sp/>nrow_alloced)<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/>*col_ptr_old<sp/>=<sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx];</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;stack_ptrs.push(col_ptr_old);</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>T<sp/>*col_ptr_new<sp/>=</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(T<sp/>*)this-&gt;sycl_target-&gt;malloc_device(nrow_required<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T));</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(col_ptr_new<sp/>!=<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;bad<sp/>pointer<sp/>from<sp/>malloc_device&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nrow_alloced<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;stack_events.<ref refid="classNESO_1_1Particles_1_1EventStack_1aee8a0be331891915bf8dccd4359aea20" kindref="member">push</ref>(this-&gt;sycl_target-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>col_ptr_new,<sp/>col_ptr_old,<sp/>nrow_existing<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T)));</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx]<sp/>=<sp/>col_ptr_new;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow_alloc[cell]<sp/>=<sp/>nrow_required;</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;stack_events.<ref refid="classNESO_1_1Particles_1_1EventStack_1aee8a0be331891915bf8dccd4359aea20" kindref="member">push</ref>(<ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cells[cell],<sp/>&amp;this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol],</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;ncol<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T<sp/>*)));</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow[cell]<sp/>=<sp/>nrow_required;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow_max<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;set_nrow&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="297" refid="classNESO_1_1Particles_1_1CellDat_1a9f37c5dfbcc18d9e7fdea2bc2363cc65" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a9f37c5dfbcc18d9e7fdea2bc2363cc65" kindref="member">wait_set_nrow</ref>()<sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>for<sp/>the<sp/>events<sp/>-<sp/>memcpys</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;stack_events.<ref refid="classNESO_1_1Particles_1_1EventStack_1a6904b30365c9a305408d7db689487aa3" kindref="member">wait</ref>();</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>can<sp/>now<sp/>free<sp/>the<sp/>pointers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!this-&gt;stack_ptrs.empty())<sp/>{</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>ptr<sp/>=<sp/>this-&gt;stack_ptrs.top();</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;free(ptr);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;stack_ptrs.pop();</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="315" refid="classNESO_1_1Particles_1_1CellDat_1a9da9e602bcf86ab73c249b094a4bedc2" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a9da9e602bcf86ab73c249b094a4bedc2" kindref="member">compute_nrow_max</ref>()<sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;nrow_max<sp/>=</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*std::max_element(std::begin(this-&gt;nrow),<sp/>std::end(this-&gt;nrow));</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;nrow_min<sp/>=</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*std::min_element(std::begin(this-&gt;nrow),<sp/>std::end(this-&gt;nrow));</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;nrow_max;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="328" refid="classNESO_1_1Particles_1_1CellDat_1af0899e1ce1a5974bb40db6ea556a0509" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1af0899e1ce1a5974bb40db6ea556a0509" kindref="member">get_nrow_max</ref>()<sp/>{</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow_max<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a9da9e602bcf86ab73c249b094a4bedc2" kindref="member">compute_nrow_max</ref>();</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;nrow_max;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="340" refid="classNESO_1_1Particles_1_1CellDat_1aa91f40f2c12db11abedfdba43b086e34" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1aa91f40f2c12db11abedfdba43b086e34" kindref="member">get_nrow_min</ref>()<sp/>{</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow_max<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a9da9e602bcf86ab73c249b094a4bedc2" kindref="member">compute_nrow_max</ref>();</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;nrow_min;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="353" refid="classNESO_1_1Particles_1_1CellDat_1ab892cccd210e814ff26c6cbda5b9b4ee" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/><ref refid="namespaceNESO_1_1Particles_1a8e7fbe7ef590c74d586c09da58870f8d" kindref="member">CellData&lt;T&gt;</ref><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ab892cccd210e814ff26c6cbda5b9b4ee" kindref="member">get_cell</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell)<sp/>{</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>();</highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cell_data<sp/>=<sp/>std::make_shared&lt;CellDataT&lt;T&gt;&gt;(</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>,<sp/>this-&gt;nrow[cell],<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow[cell]<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell_data-&gt;data[colx].data(),</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx],</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow[cell]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T));</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue.wait();</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;get_cell&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cell_data;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="382" refid="classNESO_1_1Particles_1_1CellDat_1a53cd9d7468d3ef9df59313a7e53def79" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>T<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a53cd9d7468d3ef9df59313a7e53def79" kindref="member">get_value</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col)<sp/>{</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>T<sp/>value;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.memcpy(&amp;value,<sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>col]<sp/>+<sp/>row,</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T))</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.wait_and_throw();</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="399" refid="classNESO_1_1Particles_1_1CellDat_1a24f42ab97d7ef624b00abc5391eb53ca" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a24f42ab97d7ef624b00abc5391eb53ca" kindref="member">set_value</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col,</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>value)<sp/>{</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.memcpy(this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>col]<sp/>+<sp/>row,<sp/>&amp;value,</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T))</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.wait_and_throw();</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="415" refid="classNESO_1_1Particles_1_1CellDat_1a73db3b4bb62cf56337cf6324e89d987d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a73db3b4bb62cf56337cf6324e89d987d" kindref="member">get_cell_async</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/><ref refid="classNESO_1_1Particles_1_1CellDataT" kindref="compound">CellDataT&lt;T&gt;</ref><sp/>&amp;cell_data,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1EventStack" kindref="compound">EventStack</ref><sp/>&amp;event_stack)<sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>();</highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1af8a83e5ff0c5472706a3f316b44b1d5e" kindref="member">nrow</ref><sp/>&gt;=<sp/>this-&gt;nrow[cell],</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellDataT<sp/>has<sp/>insufficent<sp/>number<sp/>of<sp/>rows&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1a87ea64d751cc9b9991a139ba9966498d" kindref="member">ncol</ref><sp/>&gt;=<sp/>this-&gt;ncol,</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellDataT<sp/>has<sp/>insufficent<sp/>number<sp/>of<sp/>columns&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow[cell]<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>event_stack.<ref refid="classNESO_1_1Particles_1_1EventStack_1aee8a0be331891915bf8dccd4359aea20" kindref="member">push</ref>(this-&gt;sycl_target-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1a35f98601c9df8edee0364daa60c888ec" kindref="member">data</ref>[colx].data(),</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx],</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;nrow[cell]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T)));</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;get_cell_async&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="444" refid="classNESO_1_1Particles_1_1CellDat_1a9ce5fe09a9def51739e97b1b541d0495" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a9ce5fe09a9def51739e97b1b541d0495" kindref="member">set_cell</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/><ref refid="namespaceNESO_1_1Particles_1a8e7fbe7ef590c74d586c09da58870f8d" kindref="member">CellData&lt;T&gt;</ref><sp/>cell_data)<sp/>{</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>();</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;write_callback)<sp/>{</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" kindref="member">write_callback</ref>(0);</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data-&gt;nrow<sp/>&gt;=<sp/>this-&gt;nrow[cell],</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellData<sp/>as<sp/>insuffient<sp/>row<sp/>count.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data-&gt;ncol<sp/>&gt;=<sp/>this-&gt;ncol,</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellData<sp/>as<sp/>insuffient<sp/>column<sp/>count.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow[cell]<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx],</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell_data-&gt;data[colx].data(),<sp/>this-&gt;nrow[cell]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T));</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;sycl_target-&gt;queue.wait();</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;set_cell&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="475" refid="classNESO_1_1Particles_1_1CellDat_1a0da9505c86e721950d87c64a42263b5d" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a0da9505c86e721950d87c64a42263b5d" kindref="member">set_cell_async</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cell,<sp/><ref refid="classNESO_1_1Particles_1_1CellDataT" kindref="compound">CellDataT&lt;T&gt;</ref><sp/>&amp;cell_data,</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1EventStack" kindref="compound">EventStack</ref><sp/>&amp;event_stack)<sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>t0<sp/>=<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>();</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;write_callback)<sp/>{</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" kindref="member">write_callback</ref>(0);</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1af8a83e5ff0c5472706a3f316b44b1d5e" kindref="member">nrow</ref><sp/>&gt;=<sp/>this-&gt;nrow[cell],</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellData<sp/>as<sp/>insuffient<sp/>row<sp/>count.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="typedefs_8hpp_1ac780e64fe76ab7e5f6b07c55de92d018" kindref="member">NESOASSERT</ref>(cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1a87ea64d751cc9b9991a139ba9966498d" kindref="member">ncol</ref><sp/>&gt;=<sp/>this-&gt;ncol,</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CellData<sp/>as<sp/>insuffient<sp/>column<sp/>count.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;nrow[cell]<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>colx<sp/>=<sp/>0;<sp/>colx<sp/>&lt;<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab076ffb3d534e96b4e420e637c311e01" kindref="member">ncol</ref>;<sp/>colx++)<sp/>{</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>event_stack.<ref refid="classNESO_1_1Particles_1_1EventStack_1aee8a0be331891915bf8dccd4359aea20" kindref="member">push</ref>(this-&gt;sycl_target-&gt;queue.memcpy(</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;h_ptr_cols[cell<sp/>*<sp/>this-&gt;ncol<sp/>+<sp/>colx],</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell_data.<ref refid="classNESO_1_1Particles_1_1CellDataT_1a35f98601c9df8edee0364daa60c888ec" kindref="member">data</ref>[colx].data(),<sp/>this-&gt;nrow[cell]<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T)));</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a6193266152265fe7e24d726a0aaade43" kindref="member">sycl_target</ref>-&gt;profile_map.inc(</highlight><highlight class="stringliteral">&quot;CellDat&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;set_cell_async&quot;</highlight><highlight class="normal">,<sp/>1,</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceNESO_1_1Particles_1aacbf134855b1ae4b7fbdefbcb8cc1b8d" kindref="member">profile_elapsed</ref>(t0,<sp/><ref refid="namespaceNESO_1_1Particles_1adc9f456b4e2feaed3199df4ba07eac75" kindref="member">profile_timestamp</ref>()));</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="506" refid="classNESO_1_1Particles_1_1CellDat_1a3336c29bf70884484f342a378c5e5df9" refkind="member"><highlight class="normal"><sp/><sp/>T<sp/>***<ref refid="classNESO_1_1Particles_1_1CellDat_1a3336c29bf70884484f342a378c5e5df9" kindref="member">device_ptr</ref>()<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(this-&gt;write_callback)<sp/>{</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1a3a9dd96242996731e76e1403bd4cf857" kindref="member">write_callback</ref>(1);</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>this-&gt;d_ptr;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="520" refid="classNESO_1_1Particles_1_1CellDat_1ad546a3f2e5b40a3523baa0ceb12d1aa4" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1ad546a3f2e5b40a3523baa0ceb12d1aa4" kindref="member">print</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>start<sp/>=<sp/>-1,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>end<sp/>=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>start<sp/>=<sp/>(start<sp/>&lt;<sp/>0)<sp/>?<sp/>0<sp/>:<sp/>start;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/>end<sp/>=<sp/>(end<sp/>&lt;<sp/>0)<sp/>?<sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1afe91231f3a7dc05dd0db26383357e310" kindref="member">ncells</ref><sp/>:<sp/>end;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cx<sp/>=<sp/>start;<sp/>cx<sp/>&lt;<sp/>end;<sp/>cx++)<sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;-------<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>cx<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>-------&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>std::endl;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>cell<sp/>=<sp/>this-&gt;<ref refid="classNESO_1_1Particles_1_1CellDat_1ab892cccd210e814ff26c6cbda5b9b4ee" kindref="member">get_cell</ref>(cx);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>cell-&gt;print();</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;-----------------&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>std::endl;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="538" refid="classNESO_1_1Particles_1_1CellDat_1a7de6b79686658384c7f44f7367f73143" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="classNESO_1_1Particles_1_1CellDat_1a7de6b79686658384c7f44f7367f73143" kindref="member">row_size</ref>()<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal">)this-&gt;ncol)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T);<sp/>}</highlight></codeline>
<codeline lineno="539"><highlight class="normal">};</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal">}<sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>NESO::Particles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="/tmp/repo-checkout/NESO-Particles/include/containers/cell_dat.hpp"/>
  </compounddef>
</doxygen>
